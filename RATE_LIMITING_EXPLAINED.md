# üõ°Ô∏è Rate Limiting Middleware - –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?

## –ß—Ç–æ —Ç–∞–∫–æ–µ Rate Limiting?

**Rate Limiting (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤)** ‚Äî —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º –∑–∞—â–∏—Ç—ã API, –∫–æ—Ç–æ—Ä—ã–π –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ IP-–∞–¥—Ä–µ—Å–∞ –≤ –µ–¥–∏–Ω–∏—Ü—É –≤—Ä–µ–º–µ–Ω–∏.

---

## üéØ –ó–∞—á–µ–º –Ω—É–∂–µ–Ω Rate Limiting?

### 1. **–ó–∞—â–∏—Ç–∞ –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π –∏ DDoS-–∞—Ç–∞–∫** üö®

**–ü—Ä–æ–±–ª–µ–º–∞ –±–µ–∑ rate-limiting:**
```
–ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å 1000+ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É
‚Üì
–°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–≥—Ä—É–∂–∞–µ—Ç—Å—è
‚Üì
–õ–µ–≥–∏—Ç–∏–º–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –º–æ–≥—É—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è API
```

**–° rate-limiting (50 req/min):**
```
–ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫: –º–∞–∫—Å–∏–º—É–º 50 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
‚Üì
–û—Å—Ç–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
‚Üì
–°–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```

**–ü—Ä–∏–º–µ—Ä –∞—Ç–∞–∫–∏:**
```bash
# –ë–µ–∑ rate-limiting –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å:
for i in {1..10000}; do
  curl http://api.example.com/api/v1/donations/init
done
# –°–µ—Ä–≤–µ—Ä —É–ø–∞–¥—ë—Ç üí•
```

### 2. **–ó–∞—â–∏—Ç–∞ –æ—Ç –±–æ—Ç–æ–≤ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∞—Ç–∞–∫** ü§ñ

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ë–æ—Ç—ã –º–æ–≥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ç—ã—Å—è—á–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –°–ø–∞–º-–±–æ—Ç—ã –∑–∞–ø–æ–ª–Ω—è—é—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Ñ–µ–π–∫–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–∫—Ä–∏–ø—Ç—ã –∫—Ä–∞–¥—É—Ç –¥–∞–Ω–Ω—ã–µ

**–° rate-limiting:**
- –ë–æ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω 50 –∑–∞–ø—Ä–æ—Å–∞–º–∏ –≤ –º–∏–Ω—É—Ç—É
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –±–∞–∑—É —Ñ–µ–π–∫–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- –ó–∞—â–∏—Ç–∞ –æ—Ç –∫—Ä–∞–∂–∏ –¥–∞–Ω–Ω—ã—Ö –º–∞—Å—Å–æ–≤—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏

**–ü—Ä–∏–º–µ—Ä –∑–∞—â–∏—Ç—ã:**
```
–ë–æ—Ç –ø—ã—Ç–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å 1000 —Ñ–µ–π–∫–æ–≤—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π:
‚Üí –ó–∞–ø—Ä–æ—Å 1-10: ‚úÖ –£—Å–ø–µ—à–Ω–æ (–ª–∏–º–∏—Ç: 10 –∫–∞–º–ø–∞–Ω–∏–π/—á–∞—Å)
‚Üí –ó–∞–ø—Ä–æ—Å 11-1000: ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (429 Too Many Requests)
```

### 3. **–ó–∞—â–∏—Ç–∞ –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö —Å–∏—Å—Ç–µ–º** üí≥

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –∫ –ø–ª–∞—Ç–µ–∂–Ω–æ–º—É –ø—Ä–æ–≤–∞–π–¥–µ—Ä—É (YooKassa, CloudPayments) –º–æ–∂–µ—Ç —Å—Ç–æ–∏—Ç—å –¥–µ–Ω–µ–≥
- –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ ‚Üí –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–∞
- –ú–æ—à–µ–Ω–Ω–∏–∫–∏ –º–æ–≥—É—Ç –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞—Ç—å —Ç—ã—Å—è—á–∏ —Ñ–µ–π–∫–æ–≤—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π

**–° rate-limiting:**
- –õ–∏–º–∏—Ç –Ω–∞ –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏—è: 20 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
- –ó–∞—â–∏—Ç–∞ –æ—Ç –º–∞—Å—Å–æ–≤—ã—Ö —Ñ–µ–π–∫–æ–≤—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π
- –°–æ–±–ª—é–¥–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤

**–ü—Ä–∏–º–µ—Ä:**
```
–ú–æ—à–µ–Ω–Ω–∏–∫ —Ö–æ—á–µ—Ç –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞—Ç—å 100 —Ñ–µ–π–∫–æ–≤—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π:
‚Üí –ó–∞–ø—Ä–æ—Å 1-20: ‚úÖ –ü—Ä–æ—Ö–æ–¥–∏—Ç (–ª–∏–º–∏—Ç: 20 req/min)
‚Üí –ó–∞–ø—Ä–æ—Å 21-100: ‚ùå –ë–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è
‚Üí YooKassa –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞–µ—Ç—Å—è
‚Üí –ê–∫–∫–∞—É–Ω—Ç –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω ‚úÖ
```

### 4. **–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤** ‚öñÔ∏è

**–ë–µ–∑ rate-limiting:**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å A: 10000 –∑–∞–ø—Ä–æ—Å–æ–≤ ‚Üí –∑–∞–Ω–∏–º–∞–µ—Ç –≤–µ—Å—å —Å–µ—Ä–≤–µ—Ä
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å B: 10 –∑–∞–ø—Ä–æ—Å–æ–≤ ‚Üí –Ω–µ –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç
```

**–° rate-limiting (50 req/min –¥–ª—è –≤—Å–µ—Ö):**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å A: –º–∞–∫—Å–∏–º—É–º 50 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å B: –º–∞–∫—Å–∏–º—É–º 50 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω
‚Üí –û–±–∞ –ø–æ–ª—É—á–∞—é—Ç —Ä–∞–≤–Ω—ã–π –¥–æ—Å—Ç—É–ø
```

### 5. **–≠–∫–æ–Ω–æ–º–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ —Å–µ—Ä–≤–µ—Ä–∞** üí∞

**–ó–∞—á–µ–º:**
- –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å —Ç—Ä–∞—Ç–∏—Ç CPU, –ø–∞–º—è—Ç—å, —Å–µ—Ç–µ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ ‚Üí —Å–µ—Ä–≤–µ—Ä –ø–∞–¥–∞–µ—Ç
- Rate-limiting ‚Üí —Å–µ—Ä–≤–µ—Ä —Å—Ç–∞–±–∏–ª–µ–Ω

**–ü—Ä–∏–º–µ—Ä —ç–∫–æ–Ω–æ–º–∏–∏:**
```
–ë–µ–∑ rate-limiting:
‚Üí 1000 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫ ‚Üí —Å–µ—Ä–≤–µ—Ä –ø–∞–¥–∞–µ—Ç ‚Üí –Ω—É–∂–µ–Ω –º–æ—â–Ω—ã–π —Å–µ—Ä–≤–µ—Ä ($500/–º–µ—Å)

–° rate-limiting:
‚Üí 50 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω ‚Üí —Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí –æ–±—ã—á–Ω—ã–π —Å–µ—Ä–≤–µ—Ä ($50/–º–µ—Å)
```

### 6. **–ó–∞—â–∏—Ç–∞ –æ—Ç brute-force –∞—Ç–∞–∫** üîê

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –ø—ã—Ç–∞–µ—Ç—Å—è —É–≥–∞–¥–∞—Ç—å –ø–∞—Ä–æ–ª—å/—Ç–æ–∫–µ–Ω
- 100000 –ø–æ–ø—ã—Ç–æ–∫ –≤ —Å–µ–∫—É–Ω–¥—É

**–° rate-limiting (5 req/min –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏):**
```
–ü–æ–ø—ã—Ç–∫–∞ 1-5: ‚úÖ
–ü–æ–ø—ã—Ç–∫–∞ 6-100000: ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ
‚Üí –ó–∞—â–∏—Ç–∞ –æ—Ç –≤–∑–ª–æ–º–∞ ‚úÖ
```

---

## üìä –¢–µ–∫—É—â–∏–µ –ª–∏–º–∏—Ç—ã –≤ –ø—Ä–æ–µ–∫—Ç–µ

| –ú–∞—Ä—à—Ä—É—Ç | –õ–∏–º–∏—Ç | –ó–∞—á–µ–º |
|---------|-------|-------|
| **–û–±—â–∏–π API** | 50 req/min | –û—Å–Ω–æ–≤–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π |
| **–ü–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏—è** | 20 req/min | –ó–∞—â–∏—Ç–∞ –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –æ—Ç —Å–ø–∞–º–∞ |
| **–ü–æ–¥–ø–∏—Å–∫–∏** | 5 req/min | –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –º–∞—Å—Å–æ–≤–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–æ–∫ |
| **–°–æ–∑–¥–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–π** | 10 req/hour | –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞ —Ñ–µ–π–∫–æ–≤—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π |
| **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** | 5 req/min | –ó–∞—â–∏—Ç–∞ –æ—Ç brute-force –∞—Ç–∞–∫ |

---

## üîç –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Rate Limiting?

### –®–∞–≥ 1: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```typescript
// –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: User ID > IP –∞–¥—Ä–µ—Å
if (user.isAuthenticated) {
  key = `user:${user.id}`  // –î–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
} else {
  key = `ip:${req.ip}`     // –î–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö (–ø–æ IP)
}
```

### –®–∞–≥ 2: –ü–æ–¥—Å—á–µ—Ç –∑–∞–ø—Ä–æ—Å–æ–≤
```
–ú–∏–Ω—É—Ç–∞ 1: [00:00 - 01:00]
  –ó–∞–ø—Ä–æ—Å 1: count = 1
  –ó–∞–ø—Ä–æ—Å 2: count = 2
  ...
  –ó–∞–ø—Ä–æ—Å 50: count = 50 ‚úÖ
  –ó–∞–ø—Ä–æ—Å 51: count = 51 ‚ùå –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù–û (429 Too Many Requests)
```

### –®–∞–≥ 3: –°–±—Ä–æ—Å –ª–∏–º–∏—Ç–∞
```
–ú–∏–Ω—É—Ç–∞ 2: [01:00 - 02:00]
  –°—á–µ—Ç—á–∏–∫ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è
  –ó–∞–ø—Ä–æ—Å—ã —Å–Ω–æ–≤–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω—ã ‚úÖ
```

---

## üì® HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏

Rate limiting –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤ –∫–∞–∂–¥—ã–π –æ—Ç–≤–µ—Ç:

```http
X-RateLimit-Limit: 50              # –õ–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤
X-RateLimit-Remaining: 45           # –û—Å—Ç–∞–ª–æ—Å—å –∑–∞–ø—Ä–æ—Å–æ–≤
X-RateLimit-Reset: 2025-01-02T12:00:00Z  # –í—Ä–µ–º—è —Å–±—Ä–æ—Å–∞
Retry-After: 60                    # –°–µ–∫—É–Ω–¥ –¥–æ —Å–±—Ä–æ—Å–∞
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ:**
```typescript
const remaining = response.headers['X-RateLimit-Remaining']
if (remaining < 10) {
  showWarning('–û—Å—Ç–∞–ª–æ—Å—å –º–∞–ª–æ –∑–∞–ø—Ä–æ—Å–æ–≤!')
}
```

---

## ‚ö†Ô∏è –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞?

### HTTP —Å—Ç–∞—Ç—É—Å: **429 Too Many Requests**

### –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞:
```json
{
  "success": false,
  "error": {
    "message": "–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.",
    "code": "RATE_LIMIT_EXCEEDED",
    "retryAfter": 60
  }
}
```

### –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:
1. –ü–æ–¥–æ–∂–¥–∞—Ç—å –¥–æ —Å–±—Ä–æ—Å–∞ –ª–∏–º–∏—Ç–∞ (—É–∫–∞–∑–∞–Ω–æ –≤ `retryAfter`)
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Retry-After` –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
3. –£–º–µ–Ω—å—à–∏—Ç—å —á–∞—Å—Ç–æ—Ç—É –∑–∞–ø—Ä–æ—Å–æ–≤

---

## üõ†Ô∏è –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–æ–µ–∫—Ç–µ?

### 1. –í—Å–µ API –º–∞—Ä—à—Ä—É—Ç—ã:
```typescript
// backend/src/index.ts
app.use('/api/v1', rateLimiters.api, routes)
```
‚úÖ **–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ API –∑–∞—â–∏—â–µ–Ω—ã –ª–∏–º–∏—Ç–æ–º 50 req/min**

### 2. –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ª–∏–º–∏—Ç—ã (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å):
```typescript
// –î–ª—è –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏–π (–±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏–π –ª–∏–º–∏—Ç)
donationsRoutes.post('/init', rateLimiters.donation, controller.init)

// –î–ª—è –ø–æ–¥–ø–∏—Å–æ–∫ (–æ—á–µ–Ω—å —Å—Ç—Ä–æ–≥–∏–π –ª–∏–º–∏—Ç)
subscriptionsRoutes.post('/init', rateLimiters.subscription, controller.init)

// –î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞–º–ø–∞–Ω–∏–π (–∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞)
campaignsRoutes.post('/', rateLimiters.campaignCreate, controller.create)
```

---

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

Rate limiting –ª–æ–≥–∏—Ä—É–µ—Ç:
- ‚úÖ **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è** –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ 80% –ª–∏–º–∏—Ç–∞
- ‚ùå **–û—à–∏–±–∫–∏** –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞

**–ü—Ä–∏–º–µ—Ä –ª–æ–≥–∞:**
```
[WARN] Rate limit warning for user:12345: 40/50 requests
[WARN] Rate limit exceeded for ip:192.168.1.1: 51 requests (limit: 50)
```

---

## üöÄ –£–ª—É—á—à–µ–Ω–∏—è –¥–ª—è production

### –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:
- ‚úÖ In-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (–±—ã—Å—Ç—Ä–æ –¥–ª—è –æ–¥–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –∏—Å—Ç—ë–∫—à–∏—Ö –∑–∞–ø–∏—Å–µ–π

### –î–ª—è production —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Å–µ—Ä–≤–µ—Ä–∞–º–∏:
- üîÑ **Redis** –¥–ª—è –æ–±—â–µ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –º–µ–∂–¥—É —Å–µ—Ä–≤–µ—Ä–∞–º–∏
- üìä **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** —á–µ—Ä–µ–∑ Prometheus/Grafana
- üîî **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤

---

## ‚úÖ –ò—Ç–æ–≥: –ó–∞—á–µ–º Rate Limiting?

| –ü—Ä–æ–±–ª–µ–º–∞ –±–µ–∑ RL | –†–µ—à–µ–Ω–∏–µ —Å RL |
|----------------|--------------|
| ‚ùå DDoS –∞—Ç–∞–∫–∏ ‚Üí —Å–µ—Ä–≤–µ—Ä –ø–∞–¥–∞–µ—Ç | ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ ‚Üí —Å–µ—Ä–≤–µ—Ä —Å—Ç–∞–±–∏–ª–µ–Ω |
| ‚ùå –ë–æ—Ç—ã —Å–ø–∞–º—è—Ç API | ‚úÖ –õ–∏–º–∏—Ç ‚Üí –±–æ—Ç—ã –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã |
| ‚ùå –ú–æ—à–µ–Ω–Ω–∏–∫–∏ ‚Üí 1000 —Ñ–µ–π–∫–æ–≤—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π | ‚úÖ –õ–∏–º–∏—Ç ‚Üí –º–∞–∫—Å–∏–º—É–º 20 –ø–ª–∞—Ç–µ–∂–µ–π/–º–∏–Ω |
| ‚ùå Brute-force –≤–∑–ª–æ–º | ‚úÖ –õ–∏–º–∏—Ç ‚Üí –º–∞–∫—Å–∏–º—É–º 5 –ø–æ–ø—ã—Ç–æ–∫/–º–∏–Ω |
| ‚ùå –û–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –≤–µ—Å—å —Å–µ—Ä–≤–µ—Ä | ‚úÖ –°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ |

---

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**Rate Limiting ‚Äî —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞—è –∑–∞—â–∏—Ç–∞ API**, –∫–æ—Ç–æ—Ä–∞—è:
1. ‚úÖ –ó–∞—â–∏—â–∞–µ—Ç –æ—Ç –∞—Ç–∞–∫ –∏ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π
2. ‚úÖ –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
3. ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ–≥—Ä—É–∑–∫—É —Å–µ—Ä–≤–µ—Ä–∞
4. ‚úÖ –°–æ–±–ª—é–¥–∞–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –¢–ó (50 req/min per user)

**–ë–µ–∑ rate-limiting –ø—Ä–æ–µ–∫—Ç —É—è–∑–≤–∏–º –∫:**
- DDoS –∞—Ç–∞–∫–∞–º
- –°–ø–∞–º-–±–æ—Ç–∞–º
- –ú–æ—à–µ–Ω–Ω–∏—á–µ—Å–∫–∏–º –¥–µ–π—Å—Ç–≤–∏—è–º
- –ü–µ—Ä–µ–≥—Ä—É–∑–∫–µ —Å–µ—Ä–≤–µ—Ä–∞

**–° rate-limiting –ø—Ä–æ–µ–∫—Ç:**
- ‚úÖ –ó–∞—â–∏—â—ë–Ω –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π
- ‚úÖ –°—Ç–∞–±–∏–ª–µ–Ω –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ
- ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏ –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–æ–µ–∫—Ç–µ!

